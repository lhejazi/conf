#!/bin/sh

if [ -t 1 ] && [ $# -lt 1 ]
then cat <<USAGE > /dev/stderr
    Usage: $0 <filename> [ <type> ]

    The filename argument is not required if the program is opened in a pipe
USAGE
    exit 1
fi

if [ -t 1 ]
then filename=$1
    if [ $# -eq 2 ]
    then type=$2
    else
        type=`echo $filename | cut -d . -f 2`
    fi

    source="@$filename"
else
    if [ $# -eq 1 ]
    then type=$1
    fi

    source="<-"
fi

link=`curl -s -F "sprunge=$source" 'http://sprunge.us'`

if [ $type ]
then echo "$link?$type"
else echo $link
fi
